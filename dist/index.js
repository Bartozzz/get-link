"use strict";var _url=require("url");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=_default;const REGEX_URL=/^(?:https?:\/\/)?(?:www\.)?([-a-zA-Z0-9_.=]{2,255}\.+(?:[a-z]{2,6})\b)(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,REGEX_DYNAMIC=/^(?:[a-z]+:[^/]\S{1,})|(?:#\S{1,})/gi,REGEX_ABSOLUTE=/^https?:\/\//i;function parseLink(a){const b=new RegExp(REGEX_URL).exec(a);if(!b||!b[1])throw new Error(`Invalid domain ${a}`);return{domain:b[1],path:b[2]}}function regenerateLink(a,b){const c=new _url.URL(a),d=b.split("/");let e=[],f="";b.startsWith("/")||(e=c.pathname.split("/"),e.pop());for(const c of d)if("."!==c)if(".."!==c)e.push(c);else if(!e.pop()||0===e.length)return null;return c.port&&(f=":"+c.port),`${c.protocol}//${c.hostname}${f}${e.join("/")}`}function _default(a,b){if("string"!=typeof b||b.match(REGEX_DYNAMIC))return a;if(b.match(REGEX_ABSOLUTE))try{const c=parseLink(a),d=parseLink(b);return c.domain===d.domain&&(d.path?new _url.URL(d.path,a).toString():new _url.URL(a).href)}catch(a){return!1}return regenerateLink(a,b)}module.exports=exports.default;